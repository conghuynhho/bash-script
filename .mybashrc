
# ggjcp will run a bash file in the directory of ggj_create_pull.sh
# ggjcp <repo> <source_branch{staging}> <target_branch>
# HOW TO USE: Merge request for target_branch to source_branch
ggjcp() {
    repo=$1
    source_branch=$2  # optional
    target_branch=$3  # branch to merge to source_branch

    # add default value for source_branch is staging
    if [ -z "$source_branch" ]; then
        source_branch="staging"
    fi

    # add default value for target_branch is current branch
    if [ -z "$target_branch" ]; then
        target_branch=$(git rev-parse --abbrev-ref HEAD)
    fi

    if [ -z "$repo" ] || [ -z "$source_branch" ] || [ -z "$target_branch" ]; then
        # echo with red text
        echo -e "\e[1;31mMissing arguments\e[0m"
        echo -e "\e[1;33mUsage: $0 <repo> <target_branch> <source_branch>\e[0m"

        echo "Github link will be: https://github.com/gogojungle/<repo>/compare/<source_branch>...<target_branch>"
        # stop the script but leave the terminal open
        return 0
    fi

    # Variable to store a pair of key-value for ggj repo which have $repo as key and $url as value
    declare -A ggj_repos=(
        ["sf"]="surface.gogojungle.co.jp"
        ["mp"]="mypage.gogojungle.co.jp"
        ["api"]="api.gogojungle.co.jp"
        ["rt"]="real-trade.tech"
        ["cf"]="configs.gogojungle.co.jp"
    )

    # Check if $repo is in the list of ggj_repos
    if [ -z "${ggj_repos[$repo]}" ]; then
        echo "Repo $repo is not in the list of ggj_repos"
        return 0
    fi

    # debug
    # echo "repo: $repo"
    # echo "target_branch: $target_branch"
    # echo "source_branch: $source_branch"
    # echo "ggj_repos[$repo]: ${ggj_repos[$repo]}"

    # Open github in your browser
    # check start command if available
    if ! command -v start &> /dev/null
    then
        echo "start could not be found"
        return 0
    fi

    # Echo with style
    echo -e "\e[1;32mOpening github in your browser\e[0m"
    echo "https://github.com/gogojungle/${ggj_repos[$repo]}/compare/${source_branch}...${target_branch}"
    start "https://github.com/gogojungle/${ggj_repos[$repo]}/compare/${source_branch}...${target_branch}"
}

mkcd ()
{
  mkdir -p -- "$1" && cd -P -- "$1"
}